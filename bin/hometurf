#!/usr/bin/env ruby
# frozen_string_literal: true

if (x = __dir__)
  $:.unshift File.expand_path("../lib", x)
end
require "hometurf/app"

puts "Project directory: #{ENV[Hometurf::Locations::PROJECT_DIR_ENVNAME]}"
puts "Home directory: #{ENV[Hometurf::Locations::HOME_DIR_ENVNAME]}"

locations = Hometurf::Locations.new
puts "locations: #{locations}"

app = Hometurf::App.new locations
args = ARGV.dup
while (arg = args.shift)
  puts "arg: #{arg}"
  case arg
  when "update"
    app.update
  when "update-each"
    while (arg = args.shift)
      pn = Pathname.new arg
      app.update_file pn
    end
  when "update-home"
    while (arg = args.shift)
      pn = Pathname.new arg
      app.update_file pn
    end
  when "status"
    app.status
  when "copy-to-project"
    while (arg = args.shift)
      pn = Pathname.new arg
      app.copy_to_project pn
    end
  when "move-to-project"
    while (arg = args.shift)
      pn = Pathname.new arg
      app.move_to_project pn
    end
  else
    $stderr.puts "unknown command: #{arg}"
  end
end
